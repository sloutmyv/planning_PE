{% extends 'core/base.html' %}

{% block title %}Manuel Utilisateur - Planning PE{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto">
    <div class="bg-white rounded-lg shadow-md">
        <!-- Header -->
        <div class="bg-blue-600 text-white px-6 py-4 rounded-t-lg">
            <h1 class="text-2xl font-bold flex items-center">
                üìñ Manuel Utilisateur ‚Äì Administration M√©tier
                <span class="ml-3 text-sm font-normal bg-blue-500 px-2 py-1 rounded">Planning PE</span>
            </h1>
            <p class="text-blue-100 mt-1">Guide pour les administrateurs m√©tier - Configuration et maintien des donn√©es</p>
        </div>

        <!-- Content -->
        <div class="p-6 space-y-8">
            <!-- Sommaire -->
            <section>
                <h2 class="text-xl font-semibold text-gray-800 border-b border-gray-200 pb-2 mb-4">
                    üìã Sommaire
                </h2>
                <div class="bg-gray-50 rounded-lg p-4">
                    <nav class="space-y-2 text-sm">
                        <div class="grid md:grid-cols-2 gap-6">
                            <div>
                                <h3 class="font-semibold text-gray-700 mb-2">Guide principal</h3>
                                <ul class="space-y-1">
                                    <li><a href="#introduction" class="text-blue-600 hover:text-blue-800 hover:underline">üè† Introduction</a></li>
                                    <li><a href="#fonctions-principales" class="text-blue-600 hover:text-blue-800 hover:underline">‚öôÔ∏è Les deux fonctions principales</a></li>
                                    <li><a href="#ordre-creation" class="text-blue-600 hover:text-blue-800 hover:underline">üìã Ordre recommand√© de cr√©ation</a></li>
                                </ul>
                            </div>
                            <div>
                                <h3 class="font-semibold text-gray-700 mb-2">Informations avanc√©es</h3>
                                <ul class="space-y-1">
                                    <li><a href="#cas-particuliers" class="text-blue-600 hover:text-blue-800 hover:underline">üîÑ Cas particuliers - Comportements automatiques</a></li>
                                </ul>
                            </div>
                        </div>
                    </nav>
                </div>
            </section>

            <!-- Introduction -->
            <section id="introduction">
                <h2 class="text-xl font-semibold text-gray-800 border-b border-gray-200 pb-2 mb-4">
                    üè† Introduction
                </h2>
                <div class="bg-blue-50 border-l-4 border-blue-400 p-4 mb-4">
                    <p class="text-blue-800">
                        Planning PE est une application d√©di√©e √† la gestion et g√©n√©ration automatique des plannings d'√©quipes.</br> 
                        Ce manuel s'adresse aux administrateurs m√©tier charg√©s de la configuration initiale et du maintien des donn√©es de l'application.
                    </p>
                </div>
                
                <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4">
                    <h3 class="font-semibold text-yellow-800 mb-2">üéØ Objectif</h3>
                    <p class="text-yellow-800">
                        D√©crire l'ordre logique de cr√©ation des √©l√©ments afin de garantir un fonctionnement coh√©rent de l'application 
                        et une g√©n√©ration correcte des plannings.
                    </p>
                </div>
            </section>

            <!-- Les deux fonctions principales -->
            <section id="fonctions-principales">
                <h2 class="text-xl font-semibold text-gray-800 border-b border-gray-200 pb-2 mb-4">
                    ‚öôÔ∏è Les Deux Fonctions Principales
                </h2>

                <div class="space-y-6">
                    <!-- Fonction 1 -->
                    <div class="bg-white border border-gray-200 rounded-lg p-6">
                        <div class="flex items-center mb-4">
                            <span class="bg-blue-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold mr-3">1</span>
                            <h3 class="text-lg font-semibold text-gray-800">Cr√©ation d'√©quipe et gestion des affectations</h3>
                        </div>
                        <div class="ml-11">
                            <p class="text-gray-600 mb-4">Cette fonction permet :</p>
                            <div class="space-y-3">
                                <div class="flex items-start space-x-3">
                                    <span class="flex-shrink-0 w-2 h-2 bg-blue-500 rounded-full mt-2"></span>
                                    <p class="text-sm text-gray-600">De cr√©er des √©quipes, rattach√©es √† un d√©partement</p>
                                </div>
                                <div class="flex items-start space-x-3">
                                    <span class="flex-shrink-0 w-2 h-2 bg-blue-500 rounded-full mt-2"></span>
                                    <p class="text-sm text-gray-600">D'ajouter ou non √† chaque √©quipe des postes</p>
                                </div>
                                <div class="flex items-start space-x-3">
                                    <span class="flex-shrink-0 w-2 h-2 bg-blue-500 rounded-full mt-2"></span>
                                    <div class="flex-1">
                                        <p class="text-sm text-gray-600 mb-2">D'associer ou non √† chaque poste :</p>
                                        <div class="ml-4 space-y-2">
                                            <div class="flex items-start space-x-2">
                                                <span class="flex-shrink-0 w-1.5 h-1.5 bg-gray-400 rounded-full mt-2"></span>
                                                <p class="text-xs text-gray-500">Un agent sur une p√©riode donn√©e</p>
                                            </div>
                                            <div class="flex items-start space-x-2">
                                                <span class="flex-shrink-0 w-1.5 h-1.5 bg-gray-400 rounded-full mt-2"></span>
                                                <p class="text-xs text-gray-500">Un plan de roulement (planning r√©current)</p>
                                            </div>
                                            <div class="flex items-start space-x-2">
                                                <span class="flex-shrink-0 w-1.5 h-1.5 bg-gray-400 rounded-full mt-2"></span>
                                                <p class="text-xs text-gray-500">Une r√®gle d'application des jours f√©ri√©s</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Fonction 2 -->
                    <div class="bg-white border border-gray-200 rounded-lg p-6">
                        <div class="flex items-center mb-4">
                            <span class="bg-blue-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold mr-3">2</span>
                            <h3 class="text-lg font-semibold text-gray-800">Cr√©ation de plans de roulement</h3>
                        </div>
                        <div class="ml-11">
                            <p class="text-gray-600 mb-3">
                                Les plans de roulement permettent de pr√©configurer un rythme de travail hebdomadaire, 
                                r√©utilisable par poste ou par √©quipe, sur une p√©riode donn√©e.
                            </p>
                            <p class="text-gray-600">
                                Ils simplifient ainsi la g√©n√©ration automatique du planning.
                            </p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Ordre recommand√© de cr√©ation -->
            <section id="ordre-creation">
                <h2 class="text-xl font-semibold text-gray-800 border-b border-gray-200 pb-2 mb-4">
                    üìã Ordre Recommand√© de Cr√©ation des Donn√©es
                </h2>
                <div class="bg-red-50 border-l-4 border-red-400 p-4 mb-6">
                    <p class="text-red-800 font-medium">
                        ‚ö†Ô∏è Fondamental : L'ordre de cr√©ation est fondamental pour garantir la coh√©rence des donn√©es et √©viter les erreurs lors de la g√©n√©ration du planning.
                    </p>
                </div>

                <div class="space-y-6">
                    <!-- √âtape 1 -->
                    <div class="bg-white border border-gray-200 rounded-lg p-6">
                        <div class="flex items-center mb-4">
                            <span class="bg-blue-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold mr-3">1</span>
                            <h3 class="text-lg font-semibold text-gray-800">D√©partements</h3>
                        </div>
                        <div class="ml-11">
                            <p class="text-gray-600 mb-3">Les d√©partements doivent √™tre cr√©√©s en premier, car une √©quipe doit obligatoirement √™tre rattach√©e √† un d√©partement.</p>
                            <div class="bg-gray-50 p-3 rounded text-sm">
                                <strong>Navigation :</strong> Administration ‚Üí üóÉÔ∏è D√©partements<br>
                                <strong>Priorit√© :</strong> Cr√©ation obligatoire avant les √©quipes
                            </div>
                        </div>
                    </div>

                    <!-- √âtape 2 -->
                    <div class="bg-white border border-gray-200 rounded-lg p-6">
                        <div class="flex items-center mb-4">
                            <span class="bg-blue-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold mr-3">2</span>
                            <h3 class="text-lg font-semibold text-gray-800">√âquipes</h3>
                        </div>
                        <div class="ml-11">
                            <p class="text-gray-600 mb-3">Une fois les d√©partements cr√©√©s, vous pouvez cr√©er une ou plusieurs √©quipes, en les rattachant √† un d√©partement existant.</p>
                            <div class="bg-gray-50 p-3 rounded text-sm">
                                <strong>D√©pendance :</strong> N√©cessite les d√©partements (√©tape 1)<br>
                                <strong>Principe :</strong> Chaque √©quipe doit √™tre rattach√©e √† un d√©partement
                            </div>
                        </div>
                    </div>

                    <!-- √âtape 3 -->
                    <div class="bg-white border border-gray-200 rounded-lg p-6">
                        <div class="flex items-center mb-4">
                            <span class="bg-blue-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold mr-3">3</span>
                            <h3 class="text-lg font-semibold text-gray-800">Postes</h3>
                        </div>
                        <div class="ml-11">
                            <p class="text-gray-600 mb-3">Chaque √©quipe peut comporter un ou plusieurs postes.</p>
                            <div class="bg-orange-50 p-3 rounded text-sm mb-3">
                                <strong>‚ö†Ô∏è Important :</strong> Les postes sont cr√©√©s dans un menu √† part enti√®re (Administration ‚Üí üóÉÔ∏è Liste des Postes). C'est seulement au moment de la cr√©ation de l'√©quipe qu'il est possible de leur affecter un agent, un plan de roulement et une r√®gle de jour f√©ri√©.
                            </div>
                            <p class="text-gray-600 mb-3">Pour chaque poste d'une √©quipe, vous pouvez d√©finir les √©l√©ments suivants :</p>
                            
                            <div class="space-y-4">
                                <div class="bg-blue-50 p-3 rounded">
                                    <h4 class="font-semibold text-blue-800 mb-2">‚û§ Affectation d'un agent</h4>
                                    <ul class="text-sm text-blue-700 space-y-1">
                                        <li>‚Ä¢ L'agent est affect√© √† sa fonction sur une p√©riode pr√©cise</li>
                                        <li>‚Ä¢ Si aucun agent n'est affect√©, mais qu'un plan de roulement est d√©fini, le poste sera trait√© comme "Poste Vacant" (type d'horaire : PV) lors de la g√©n√©ration du planning</li>
                                        <li>‚Ä¢ <strong>Pr√©requis :</strong> Pour affecter un agent, l'agent doit √™tre cr√©√© au pr√©alable (Administration ‚Üí üóÉÔ∏è Liste des Agents)</li>
                                    </ul>
                                </div>
                                
                                <div class="bg-green-50 p-3 rounded">
                                    <h4 class="font-semibold text-green-800 mb-2">‚û§ Plan de roulement associ√©</h4>
                                    <ul class="text-sm text-green-700 space-y-1">
                                        <li>‚Ä¢ Le plan s'appliquera automatiquement √† ce poste sur la p√©riode d√©finie</li>
                                        <li>‚Ä¢ <strong>Pr√©requis :</strong> Pour affecter un plan, le plan doit √™tre cr√©√© au pr√©alable (Administration ‚Üí üóÉÔ∏è Roulements Hedbomadaires)</li>
                                    </ul>
                                </div>
                                
                                <div class="bg-purple-50 p-3 rounded">
                                    <h4 class="font-semibold text-purple-800 mb-2">‚û§ R√®gle sur les jours f√©ri√©s</h4>
                                    <ul class="text-sm text-purple-700 space-y-1">
                                        <li>‚Ä¢ Il est possible d'indiquer si le poste b√©n√©ficie ou non des jours f√©ri√©s</li>
                                        <li>‚Ä¢ Cela influence la g√©n√©ration du planning : les jours f√©ri√©s peuvent annuler ou modifier les jours de travail issus du plan de roulement</li>
                                        <li>‚Ä¢ <strong>Pr√©requis :</strong> Pour affecter la liste des jours f√©ri√©s, elle doit comporter des jours f√©ri√©s au pr√©alable (Administration ‚Üí üóÉÔ∏è Jours F√©ri√©s)</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- √âtape 4 -->
                    <div class="bg-white border border-gray-200 rounded-lg p-6">
                        <div class="flex items-center mb-4">
                            <span class="bg-blue-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold mr-3">4</span>
                            <h3 class="text-lg font-semibold text-gray-800">Types d'horaires</h3>
                        </div>
                        <div class="ml-11">
                            <p class="text-gray-600 mb-3">Les types d'horaires sont des cat√©gories de travail (ex : Jour travaill√©, Cong√© pay√©, Astreinte sur site...).</p>
                            <div class="bg-gray-50 p-3 rounded text-sm">
                                <strong>Navigation :</strong> Administration ‚Üí üóÉÔ∏è Types d'horaires<br>
                                <strong>Priorit√© :</strong> Ils doivent √™tre cr√©√©s avant les rythmes quotidiens, car ces derniers en d√©pendent
                            </div>
                        </div>
                    </div>

                    <!-- √âtape 5 -->
                    <div class="bg-white border border-gray-200 rounded-lg p-6">
                        <div class="flex items-center mb-4">
                            <span class="bg-blue-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold mr-3">5</span>
                            <h3 class="text-lg font-semibold text-gray-800">Rythmes quotidiens</h3>
                        </div>
                        <div class="ml-11">
                            <p class="text-gray-600 mb-3">Les rythmes quotidiens repr√©sentent la composition d'une journ√©e de travail (ex : 7h-19h) associ√© √† un type d'horaire.</p>
                            <div class="bg-gray-50 p-3 rounded text-sm">
                                <strong>Navigation :</strong> Administration ‚Üí üóÉÔ∏è Rythmes Quotidien<br>
                                <strong>D√©pendance :</strong> N√©cessite les types d'horaire (√©tape 4)<br>
                                <strong>Usage :</strong> Ces rythmes sont les briques de base des plans de roulement
                            </div>
                        </div>
                    </div>

                    <!-- √âtape 6 -->
                    <div class="bg-white border border-gray-200 rounded-lg p-6">
                        <div class="flex items-center mb-4">
                            <span class="bg-green-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold mr-3">6</span>
                            <h3 class="text-lg font-semibold text-gray-800">Plans de roulement</h3>
                        </div>
                        <div class="ml-11">
                            <p class="text-gray-600 mb-3">Un plan de roulement est une s√©quence hebdomadaire (ou multi-hebdomadaire) de rythmes quotidiens.</p>
                            <div class="bg-gray-50 p-3 rounded text-sm">
                                <strong>Navigation :</strong> Administration ‚Üí üóÉÔ∏è Roulements Hebdomadaires<br>
                                <strong>D√©pendance :</strong> N√©cessite les rythmes quotidiens (√©tape 5)<br>
                                <strong>Application :</strong> Il pourra ensuite √™tre appliqu√© √† un poste ou √† une √©quipe
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Cas particuliers -->
            <section id="cas-particuliers">
                <h2 class="text-xl font-semibold text-gray-800 border-b border-gray-200 pb-2 mb-4">
                    üîÑ Cas particuliers ‚Äì Comportements automatiques
                </h2>
                
                <div class="bg-indigo-50 border-l-4 border-indigo-400 p-4 mb-6">
                    <h3 class="font-semibold text-indigo-800 mb-2">Comportement du syst√®me</h3>
                    <p class="text-indigo-700 text-sm">
                        Le syst√®me adopte des comportements automatiques selon la configuration des postes. 
                        Voici les diff√©rents scenarios possibles :
                    </p>
                </div>

                <div class="space-y-4">
                    <!-- Scenario 1 -->
                    <div class="bg-white border border-gray-200 rounded-lg p-4">
                        <div class="flex items-start">
                            <span class="bg-orange-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold mr-3 mt-1">1</span>
                            <div class="flex-1">
                                <h4 class="font-semibold text-gray-800 mb-2">Poste avec plan de roulement mais sans agent</h4>
                                <p class="text-sm text-gray-600">
                                    ‚Üí <strong>G√©n√©ration automatique</strong> de planning avec "Poste Vacant" (PV) comme type d'horaire 
                                    en lieu et place du type d'horaire pr√©existant.
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Scenario 2 -->
                    <div class="bg-white border border-gray-200 rounded-lg p-4">
                        <div class="flex items-start">
                            <span class="bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold mr-3 mt-1">2</span>
                            <div class="flex-1">
                                <h4 class="font-semibold text-gray-800 mb-2">Poste avec agent mais sans plan de roulement</h4>
                                <p class="text-sm text-gray-600">
                                    ‚Üí <strong>La ligne de planning de l'agent reste vide</strong>
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Scenario 3 -->
                    <div class="bg-white border border-gray-200 rounded-lg p-4">
                        <div class="flex items-start">
                            <span class="bg-green-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold mr-3 mt-1">3</span>
                            <div class="flex-1">
                                <h4 class="font-semibold text-gray-800 mb-2">Poste avec agent et plan de roulement</h4>
                                <p class="text-sm text-gray-600">
                                    ‚Üí <strong>Planning g√©n√©r√© automatiquement</strong> avec les rythmes d√©finis
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Scenario 4 -->
                    <div class="bg-white border border-gray-200 rounded-lg p-4">
                        <div class="flex items-start">
                            <span class="bg-blue-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold mr-3 mt-1">4</span>
                            <div class="flex-1">
                                <h4 class="font-semibold text-gray-800 mb-2">Poste exclu des jours f√©ri√©s</h4>
                                <p class="text-sm text-gray-600">
                                    ‚Üí <strong>Le roulement s'applique sans tenir compte des jours f√©ri√©s</strong>
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Scenario 5 -->
                    <div class="bg-white border border-gray-200 rounded-lg p-4">
                        <div class="flex items-start">
                            <span class="bg-purple-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold mr-3 mt-1">5</span>
                            <div class="flex-1">
                                <h4 class="font-semibold text-gray-800 mb-2">Poste inclus dans les jours f√©ri√©s</h4>
                                <p class="text-sm text-gray-600 mb-2">
                                    ‚Üí <strong>Le planning est modifi√© ou annul√© selon les jours f√©ri√©s</strong>
                                </p>
                                <div class="bg-purple-50 p-2 rounded text-xs text-purple-700">
                                    <strong>Exemple :</strong> Si le lundi est f√©ri√© mais initialement associ√© √† un rythme quotidien 
                                    dans le plan de roulement, alors le rythme de ce jour est supprim√©.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Note importante -->
                <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mt-6">
                    <h4 class="font-semibold text-yellow-800 mb-2">üí° Principe important de pr√©servation des donn√©es</h4>
                    <p class="text-sm text-yellow-700 mb-2">
                        Il faut bien comprendre que ce qui est g√©n√©r√© remplit automatiquement le planning mais reste "en dessous" 
                        de ce que les utilisateurs imputent au planning manuellement.
                    </p>
                    <div class="bg-yellow-100 p-3 rounded text-xs text-yellow-800">
                        <strong>Exemple concret :</strong> Si dans une √©quipe j'associe un poste et un agent mais sans plan de roulement, 
                        je peux alors imputer un rythme quotidien associ√© √† un type d'horaire sur un jour particulier √† un agent. 
                        Mais si j'associe dans un second temps √† ce poste un roulement, le roulement se g√©n√®re sur le planning 
                        mais <strong>sans √©craser les jours d√©j√† d√©finis en amont</strong>. Ceci pour ne pas perdre de donn√©es.
                    </div>
                </div>
            </section>
        </div>
    </div>
</div>
{% endblock %}