{% extends 'core/base.html' %}

{% block title %}Manuel Utilisateur - Planning PE{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto">
    <div class="bg-white rounded-lg shadow-md">
        <!-- Header -->
        <div class="bg-gray-800 text-white px-6 py-4 rounded-t-lg">
            <h1 class="text-2xl font-bold">
                Manuel Utilisateur – Administration Métier
                <span class="ml-3 text-sm font-normal bg-gray-700 px-2 py-1 rounded">Planning PE</span>
            </h1>
            <p class="text-gray-300 mt-1">Guide pour les administrateurs métier - Configuration et maintien des données</p>
        </div>

        <!-- Content -->
        <div class="p-6 space-y-8">
            <!-- Sommaire -->
            <section>
                <h2 class="text-xl font-semibold text-gray-800 border-b border-gray-300 pb-2 mb-4">
                    Sommaire
                </h2>
                <div class="bg-gray-100 rounded-lg p-4 border">
                    <nav class="space-y-3 text-sm">
                        <ol class="list-decimal list-inside space-y-1">
                            <li><a href="#introduction" class="text-gray-700 hover:text-gray-900 hover:underline font-medium">Introduction et objectifs</a></li>
                            <li><a href="#architecture-systeme" class="text-gray-700 hover:text-gray-900 hover:underline font-medium">Architecture du système</a>
                                <ol class="list-decimal list-inside ml-6 mt-1 space-y-1">
                                    <li><a href="#fonctions-principales" class="text-gray-600 hover:text-gray-800 hover:underline">Fonctions principales</a></li>
                                    <li><a href="#architecture-donnees" class="text-gray-600 hover:text-gray-800 hover:underline">Architecture des données</a></li>
                                    <li><a href="#permissions-acces" class="text-gray-600 hover:text-gray-800 hover:underline">Système de permissions</a></li>
                                </ol>
                            </li>
                            <li><a href="#guide-utilisation" class="text-gray-700 hover:text-gray-900 hover:underline font-medium">Guide d'utilisation</a>
                                <ol class="list-decimal list-inside ml-6 mt-1 space-y-1">
                                    <li><a href="#ordre-creation" class="text-gray-600 hover:text-gray-800 hover:underline">Ordre de création des données</a></li>
                                    <li><a href="#gestion-modules" class="text-gray-600 hover:text-gray-800 hover:underline">Gestion des modules</a></li>
                                    <li><a href="#cas-particuliers" class="text-gray-600 hover:text-gray-800 hover:underline">Comportements automatiques</a></li>
                                </ol>
                            </li>
                            <li><a href="#administration-avancee" class="text-gray-700 hover:text-gray-900 hover:underline font-medium">Administration avancée</a>
                                <ol class="list-decimal list-inside ml-6 mt-1 space-y-1">
                                    <li><a href="#import-export" class="text-gray-600 hover:text-gray-800 hover:underline">Import/Export des données</a></li>
                                    <li><a href="#interface-django" class="text-gray-600 hover:text-gray-800 hover:underline">Interface Django Admin</a></li>
                                </ol>
                            </li>
                        </ol>
                    </nav>
                </div>
            </section>

            <!-- I) Introduction -->
            <section id="introduction">
                <h2 class="text-xl font-semibold text-gray-800 border-b border-gray-200 pb-2 mb-4">
                    I) Introduction et objectifs
                </h2>
                
                <div class="space-y-6">
                    <!-- Présentation -->
                    <div class="bg-gray-50 border-l-4 border-gray-500 p-4">
                        <h3 class="font-semibold text-gray-800 mb-2">I.1) Présentation de l'application</h3>
                        <p class="text-gray-700">
                            Planning PE est une application web dédiée à la gestion et génération automatique des plannings d'équipes. 
                            Elle offre une interface utilisateur moderne pour l'administration des données de planification.
                        </p>
                    </div>
                    
                    <!-- Public cible -->
                    <div class="bg-gray-50 border-l-4 border-gray-500 p-4">
                        <h3 class="font-semibold text-gray-800 mb-2">I.2) Public cible du manuel</h3>
                        <p class="text-gray-700">
                            Ce manuel s'adresse exclusivement aux <strong>administrateurs métier</strong> chargés de la configuration initiale 
                            et du maintien des données de l'application. Il se concentre sur l'utilisation opérationnelle.
                        </p>
                    </div>
                    
                    <!-- Objectifs -->
                    <div class="bg-gray-50 border-l-4 border-gray-500 p-4">
                        <h3 class="font-semibold text-gray-800 mb-2">I.3) Objectifs du manuel</h3>
                        <div class="text-gray-700 space-y-1">
                            <p>• Décrire l'ordre logique de création des éléments pour garantir la cohérence des données</p>
                            <p>• Expliquer les fonctionnalités d'administration et leurs interactions</p>
                            <p>• Documenter les procédures d'import/export et de sauvegarde</p>
                            <p>• Présenter les comportements automatiques du système</p>
                        </div>
                    </div>

                    <!-- Navigation -->
                    <div class="bg-gray-50 border-l-4 border-gray-500 p-4">
                        <h3 class="font-semibold text-gray-800 mb-2">I.4) Navigation dans l'application</h3>
                        <div class="text-gray-700 space-y-1 text-sm">
                            <p><strong>Accès principal :</strong> http://127.0.0.1:8000/</p>
                            <p><strong>Menu Administration :</strong> Interface adaptative selon les permissions utilisateur</p>
                            <p><strong>Interface Django Admin :</strong> http://127.0.0.1:8000/admin/ (superutilisateurs uniquement)</p>
                            <p><strong>Ordre des menus :</strong> Organisé selon la séquence logique de création</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- II) Architecture du système -->
            <section id="architecture-systeme">
                <h2 class="text-xl font-semibold text-gray-800 border-b border-gray-200 pb-2 mb-4">
                    II) Architecture du système
                </h2>

            <!-- II.1) Fonctions principales -->
            <section id="fonctions-principales">
                <h3 class="text-lg font-semibold text-gray-700 border-b border-gray-200 pb-2 mb-4">
                    II.1) Fonctions principales du système
                </h3>

                <div class="space-y-4">
                    <!-- Fonction 1 -->
                    <div class="bg-gray-50 border border-gray-300 rounded-lg p-4">
                        <h4 class="font-semibold text-gray-800 mb-2">II.1.1) Gestion des équipes et affectations</h4>
                        <div class="text-gray-700 text-sm space-y-1">
                            <p>Cette fonction permet de structurer l'organisation en créant :</p>
                            <p>• Des équipes rattachées à des départements</p>
                            <p>• Des postes au sein de chaque équipe</p>
                            <p>• L'affectation d'agents, plans de roulement et règles de jours fériés aux postes</p>
                        </div>
                    </div>

                    <!-- Fonction 2 -->
                    <div class="bg-gray-50 border border-gray-300 rounded-lg p-4">
                        <h4 class="font-semibold text-gray-800 mb-2">II.1.2) Création de plans de roulement</h4>
                        <div class="text-gray-700 text-sm">
                            <p>Permet de préconfigurer des rythmes de travail hebdomadaires réutilisables, 
                            simplifiant la génération automatique des plannings sur des périodes définies.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- II.2) Architecture des données -->
            <section id="architecture-donnees">
                <h3 class="text-lg font-semibold text-gray-700 border-b border-gray-200 pb-2 mb-4">
                    II.2) Architecture des données et interconnexions
                </h3>
                
                <div class="bg-gray-50 border-l-4 border-gray-400 p-4 mb-6">
                    <p class="text-gray-800">
                        Voici un schéma illustrant les relations entre les principales entités de l'application. 
                        Les flèches indiquent les dépendances : une entité doit exister avant celles qui en dépendent.
                    </p>
                </div>

                <!-- Database Schema Diagram -->
                <div class="bg-white border-2 border-gray-300 rounded-lg p-6 mb-6 overflow-x-auto">
                    <div class="min-w-max">
                        <svg viewBox="0 0 1200 850" class="w-full h-auto" style="max-height: 600px;">
                            <!-- Background -->
                            <rect width="1200" height="850" fill="#f8fafc"/>
                            
                            <!-- Legend -->
                            <g transform="translate(20, 20)">
                                <text x="0" y="0" class="text-sm font-bold" fill="#374151">Légende :</text>
                                <line x1="0" y1="15" x2="30" y2="15" stroke="#3b82f6" stroke-width="2" marker-end="url(#arrowhead)"/>
                                <text x="35" y="19" class="text-xs" fill="#374151">Clé étrangère (A → B : B.field_id → A.id)</text>
                                <rect x="0" y="30" width="15" height="15" fill="#dbeafe" stroke="#3b82f6" stroke-width="1"/>
                                <text x="20" y="42" class="text-xs" fill="#374151">Table de données</text>
                                <text x="0" y="58" class="text-xs font-bold" fill="#dc2626">PK</text>
                                <text x="20" y="58" class="text-xs" fill="#374151">= Clé primaire</text>
                                <text x="80" y="58" class="text-xs font-bold" fill="#059669">FK</text>
                                <text x="100" y="58" class="text-xs" fill="#374151">= Clé étrangère</text>
                            </g>
                            
                            <!-- Arrow marker definition -->
                            <defs>
                                <marker id="arrowhead" markerWidth="10" markerHeight="7" 
                                        refX="10" refY="3.5" orient="auto">
                                    <polygon points="0 0, 10 3.5, 0 7" fill="#3b82f6"/>
                                </marker>
                            </defs>
                            
                            <!-- Departments (Top level) -->
                            <g transform="translate(450, 100)">
                                <rect width="160" height="85" fill="#dbeafe" stroke="#3b82f6" stroke-width="2" rx="8"/>
                                <text x="80" y="18" text-anchor="middle" class="text-sm font-bold" fill="#1e40af">Department</text>
                                <line x1="10" y1="23" x2="150" y2="23" stroke="#1e40af" stroke-width="1"/>
                                <text x="12" y="36" class="text-xs font-bold" fill="#dc2626">PK</text>
                                <text x="30" y="36" class="text-xs" fill="#1e40af">id</text>
                                <text x="12" y="49" class="text-xs" fill="#1e40af">name</text>
                                <text x="12" y="62" class="text-xs" fill="#1e40af">order</text>
                                <text x="80" y="79" text-anchor="middle" class="text-xs font-bold" fill="#dc2626">ÉTAPE 1</text>
                            </g>
                            
                            <!-- Schedule Types -->
                            <g transform="translate(120, 220)">
                                <rect width="160" height="85" fill="#dcfce7" stroke="#16a34a" stroke-width="2" rx="8"/>
                                <text x="80" y="18" text-anchor="middle" class="text-sm font-bold" fill="#15803d">ScheduleType</text>
                                <line x1="10" y1="23" x2="150" y2="23" stroke="#15803d" stroke-width="1"/>
                                <text x="12" y="36" class="text-xs font-bold" fill="#dc2626">PK</text>
                                <text x="30" y="36" class="text-xs" fill="#15803d">id</text>
                                <text x="12" y="49" class="text-xs" fill="#15803d">designation</text>
                                <text x="12" y="62" class="text-xs" fill="#15803d">color</text>
                                <text x="80" y="79" text-anchor="middle" class="text-xs font-bold" fill="#dc2626">ÉTAPE 4</text>
                            </g>
                            
                            <!-- Public Holidays -->
                            <g transform="translate(800, 220)">
                                <rect width="160" height="85" fill="#fef3c7" stroke="#f59e0b" stroke-width="2" rx="8"/>
                                <text x="80" y="18" text-anchor="middle" class="text-sm font-bold" fill="#d97706">PublicHoliday</text>
                                <line x1="10" y1="23" x2="150" y2="23" stroke="#d97706" stroke-width="1"/>
                                <text x="12" y="36" class="text-xs font-bold" fill="#dc2626">PK</text>
                                <text x="30" y="36" class="text-xs" fill="#d97706">id</text>
                                <text x="12" y="49" class="text-xs" fill="#d97706">designation</text>
                                <text x="12" y="62" class="text-xs" fill="#d97706">date</text>
                                <text x="80" y="79" text-anchor="middle" class="text-xs font-bold" fill="#dc2626">OPTIONNEL</text>
                            </g>
                            
                            <!-- Functions/Postes -->
                            <g transform="translate(40, 360)">
                                <rect width="160" height="85" fill="#e0e7ff" stroke="#6366f1" stroke-width="2" rx="8"/>
                                <text x="80" y="18" text-anchor="middle" class="text-sm font-bold" fill="#4338ca">Function</text>
                                <line x1="10" y1="23" x2="150" y2="23" stroke="#4338ca" stroke-width="1"/>
                                <text x="12" y="36" class="text-xs font-bold" fill="#dc2626">PK</text>
                                <text x="30" y="36" class="text-xs" fill="#4338ca">id</text>
                                <text x="12" y="49" class="text-xs" fill="#4338ca">designation</text>
                                <text x="12" y="62" class="text-xs" fill="#4338ca">status</text>
                                <text x="80" y="79" text-anchor="middle" class="text-xs font-bold" fill="#dc2626">ÉTAPE 3</text>
                            </g>
                            
                            <!-- Agents -->
                            <g transform="translate(240, 360)">
                                <rect width="160" height="85" fill="#fce7f3" stroke="#ec4899" stroke-width="2" rx="8"/>
                                <text x="80" y="18" text-anchor="middle" class="text-sm font-bold" fill="#be185d">Agent</text>
                                <line x1="10" y1="23" x2="150" y2="23" stroke="#be185d" stroke-width="1"/>
                                <text x="12" y="36" class="text-xs font-bold" fill="#dc2626">PK</text>
                                <text x="30" y="36" class="text-xs" fill="#be185d">id</text>
                                <text x="12" y="49" class="text-xs" fill="#be185d">first_name, last_name</text>
                                <text x="12" y="62" class="text-xs" fill="#be185d">matricule</text>
                                <text x="80" y="79" text-anchor="middle" class="text-xs font-bold" fill="#dc2626">ÉTAPE 3</text>
                            </g>
                            
                            <!-- Daily Rotation Plans -->
                            <g transform="translate(440, 360)">
                                <rect width="160" height="100" fill="#dcfce7" stroke="#16a34a" stroke-width="2" rx="8"/>
                                <text x="80" y="18" text-anchor="middle" class="text-sm font-bold" fill="#15803d">DailyRotationPlan</text>
                                <line x1="10" y1="23" x2="150" y2="23" stroke="#15803d" stroke-width="1"/>
                                <text x="12" y="36" class="text-xs font-bold" fill="#dc2626">PK</text>
                                <text x="30" y="36" class="text-xs" fill="#15803d">id</text>
                                <text x="12" y="49" class="text-xs" fill="#15803d">designation</text>
                                <text x="12" y="62" class="text-xs font-bold" fill="#059669">FK</text>
                                <text x="30" y="62" class="text-xs" fill="#15803d">schedule_type_id</text>
                                <text x="80" y="95" text-anchor="middle" class="text-xs font-bold" fill="#dc2626">ÉTAPE 5</text>
                            </g>
                            
                            <!-- Rotation Periods -->
                            <g transform="translate(640, 360)">
                                <rect width="160" height="115" fill="#dcfce7" stroke="#16a34a" stroke-width="2" rx="8"/>
                                <text x="80" y="18" text-anchor="middle" class="text-sm font-bold" fill="#15803d">RotationPeriod</text>
                                <line x1="10" y1="23" x2="150" y2="23" stroke="#15803d" stroke-width="1"/>
                                <text x="12" y="36" class="text-xs font-bold" fill="#dc2626">PK</text>
                                <text x="30" y="36" class="text-xs" fill="#15803d">id</text>
                                <text x="12" y="49" class="text-xs font-bold" fill="#059669">FK</text>
                                <text x="30" y="49" class="text-xs" fill="#15803d">daily_rotation_plan_id</text>
                                <text x="12" y="62" class="text-xs" fill="#15803d">start_date, end_date</text>
                                <text x="12" y="75" class="text-xs" fill="#15803d">start_time, end_time</text>
                            </g>
                            
                            <!-- Shift Schedules -->
                            <g transform="translate(300, 540)">
                                <rect width="160" height="85" fill="#f3e8ff" stroke="#8b5cf6" stroke-width="2" rx="8"/>
                                <text x="80" y="18" text-anchor="middle" class="text-sm font-bold" fill="#7c3aed">ShiftSchedule</text>
                                <line x1="10" y1="23" x2="150" y2="23" stroke="#7c3aed" stroke-width="1"/>
                                <text x="12" y="36" class="text-xs font-bold" fill="#dc2626">PK</text>
                                <text x="30" y="36" class="text-xs" fill="#7c3aed">id</text>
                                <text x="12" y="49" class="text-xs" fill="#7c3aed">name</text>
                                <text x="12" y="62" class="text-xs" fill="#7c3aed">type</text>
                                <text x="80" y="79" text-anchor="middle" class="text-xs font-bold" fill="#dc2626">ÉTAPE 6</text>
                            </g>
                            
                            <!-- Shift Schedule Periods -->
                            <g transform="translate(520, 540)">
                                <rect width="160" height="100" fill="#f3e8ff" stroke="#8b5cf6" stroke-width="2" rx="8"/>
                                <text x="80" y="18" text-anchor="middle" class="text-sm font-bold" fill="#7c3aed">ShiftSchedulePeriod</text>
                                <line x1="10" y1="23" x2="150" y2="23" stroke="#7c3aed" stroke-width="1"/>
                                <text x="12" y="36" class="text-xs font-bold" fill="#dc2626">PK</text>
                                <text x="30" y="36" class="text-xs" fill="#7c3aed">id</text>
                                <text x="12" y="49" class="text-xs font-bold" fill="#059669">FK</text>
                                <text x="30" y="49" class="text-xs" fill="#7c3aed">shift_schedule_id</text>
                                <text x="12" y="62" class="text-xs" fill="#7c3aed">start_date, end_date</text>
                            </g>
                            
                            <!-- Shift Schedule Weeks -->
                            <g transform="translate(300, 690)">
                                <rect width="160" height="100" fill="#f3e8ff" stroke="#8b5cf6" stroke-width="2" rx="8"/>
                                <text x="80" y="18" text-anchor="middle" class="text-sm font-bold" fill="#7c3aed">ShiftScheduleWeek</text>
                                <line x1="10" y1="23" x2="150" y2="23" stroke="#7c3aed" stroke-width="1"/>
                                <text x="12" y="36" class="text-xs font-bold" fill="#dc2626">PK</text>
                                <text x="30" y="36" class="text-xs" fill="#7c3aed">id</text>
                                <text x="12" y="49" class="text-xs font-bold" fill="#059669">FK</text>
                                <text x="30" y="49" class="text-xs" fill="#7c3aed">period_id</text>
                                <text x="12" y="62" class="text-xs" fill="#7c3aed">week_number</text>
                            </g>
                            
                            <!-- Shift Schedule Daily Plans -->
                            <g transform="translate(520, 690)">
                                <rect width="160" height="115" fill="#f3e8ff" stroke="#8b5cf6" stroke-width="2" rx="8"/>
                                <text x="80" y="18" text-anchor="middle" class="text-sm font-bold" fill="#7c3aed">ShiftScheduleDailyPlan</text>
                                <line x1="10" y1="23" x2="150" y2="23" stroke="#7c3aed" stroke-width="1"/>
                                <text x="12" y="36" class="text-xs font-bold" fill="#dc2626">PK</text>
                                <text x="30" y="36" class="text-xs" fill="#7c3aed">id</text>
                                <text x="12" y="49" class="text-xs font-bold" fill="#059669">FK</text>
                                <text x="30" y="49" class="text-xs" fill="#7c3aed">week_id</text>
                                <text x="12" y="62" class="text-xs font-bold" fill="#059669">FK</text>
                                <text x="30" y="62" class="text-xs" fill="#7c3aed">daily_rotation_plan_id</text>
                                <text x="12" y="75" class="text-xs" fill="#7c3aed">weekday</text>
                            </g>
                            
                            <!-- Foreign Key Relationships with field labels -->
                            
                            <!-- ScheduleType → DailyRotationPlan -->
                            <line x1="280" y1="262" x2="440" y2="390" stroke="#3b82f6" stroke-width="2" marker-end="url(#arrowhead)"/>
                            <text x="340" y="320" class="text-xs font-semibold" fill="#3b82f6" transform="rotate(-25 340 320)">schedule_type_id</text>
                            
                            <!-- DailyRotationPlan → RotationPeriod -->
                            <line x1="600" y1="410" x2="640" y2="410" stroke="#3b82f6" stroke-width="2" marker-end="url(#arrowhead)"/>
                            <text x="605" y="403" class="text-xs font-semibold" fill="#3b82f6">daily_rotation_plan_id</text>
                            
                            <!-- ShiftSchedule → ShiftSchedulePeriod -->
                            <line x1="460" y1="582" x2="520" y2="582" stroke="#3b82f6" stroke-width="2" marker-end="url(#arrowhead)"/>
                            <text x="475" y="575" class="text-xs font-semibold" fill="#3b82f6">shift_schedule_id</text>
                            
                            <!-- ShiftSchedulePeriod → ShiftScheduleWeek -->
                            <line x1="560" y1="640" x2="420" y2="690" stroke="#3b82f6" stroke-width="2" marker-end="url(#arrowhead)"/>
                            <text x="470" y="660" class="text-xs font-semibold" fill="#3b82f6" transform="rotate(-15 470 660)">period_id</text>
                            
                            <!-- ShiftScheduleWeek → ShiftScheduleDailyPlan -->
                            <line x1="460" y1="740" x2="520" y2="740" stroke="#3b82f6" stroke-width="2" marker-end="url(#arrowhead)"/>
                            <text x="475" y="733" class="text-xs font-semibold" fill="#3b82f6">week_id</text>
                            
                            <!-- DailyRotationPlan → ShiftScheduleDailyPlan -->
                            <path d="M 520 460 Q 750 550 600 690" stroke="#3b82f6" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
                            <text x="670" y="580" class="text-xs font-semibold" fill="#3b82f6" transform="rotate(45 670 580)">daily_rotation_plan_id</text>
                        </svg>
                    </div>
                </div>

                <!-- Explanation -->
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                        <h3 class="font-semibold text-blue-800 mb-3">🔗 Relations entre tables (clés étrangères)</h3>
                        <div class="space-y-2 text-sm text-blue-700">
                            <div class="flex items-start space-x-2">
                                <span class="w-2 h-2 bg-blue-500 rounded-full mt-1.5"></span>
                                <p><strong>DailyRotationPlan.schedule_type_id</strong> → ScheduleType.id</p>
                            </div>
                            <div class="flex items-start space-x-2">
                                <span class="w-2 h-2 bg-blue-500 rounded-full mt-1.5"></span>
                                <p><strong>RotationPeriod.daily_rotation_plan_id</strong> → DailyRotationPlan.id</p>
                            </div>
                            <div class="flex items-start space-x-2">
                                <span class="w-2 h-2 bg-blue-500 rounded-full mt-1.5"></span>
                                <p><strong>ShiftSchedulePeriod.shift_schedule_id</strong> → ShiftSchedule.id</p>
                            </div>
                            <div class="flex items-start space-x-2">
                                <span class="w-2 h-2 bg-blue-500 rounded-full mt-1.5"></span>
                                <p><strong>ShiftScheduleWeek.period_id</strong> → ShiftSchedulePeriod.id</p>
                            </div>
                            <div class="flex items-start space-x-2">
                                <span class="w-2 h-2 bg-blue-500 rounded-full mt-1.5"></span>
                                <p><strong>ShiftScheduleDailyPlan.week_id</strong> → ShiftScheduleWeek.id</p>
                            </div>
                            <div class="flex items-start space-x-2">
                                <span class="w-2 h-2 bg-blue-500 rounded-full mt-1.5"></span>
                                <p><strong>ShiftScheduleDailyPlan.daily_rotation_plan_id</strong> → DailyRotationPlan.id</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-orange-50 border border-orange-200 rounded-lg p-4">
                        <h3 class="font-semibold text-orange-800 mb-3">⚡ Points clés de structure</h3>
                        <div class="space-y-2 text-sm text-orange-700">
                            <div class="flex items-start space-x-2">
                                <span class="w-2 h-2 bg-orange-500 rounded-full mt-1.5"></span>
                                <p><strong>PK</strong> = Clé primaire (identifiant unique)</p>
                            </div>
                            <div class="flex items-start space-x-2">
                                <span class="w-2 h-2 bg-orange-500 rounded-full mt-1.5"></span>
                                <p><strong>FK</strong> = Clé étrangère (référence vers autre table)</p>
                            </div>
                            <div class="flex items-start space-x-2">
                                <span class="w-2 h-2 bg-orange-500 rounded-full mt-1.5"></span>
                                <p>Les flèches montrent le sens des dépendances</p>
                            </div>
                            <div class="flex items-start space-x-2">
                                <span class="w-2 h-2 bg-orange-500 rounded-full mt-1.5"></span>
                                <p>Une table "enfant" ne peut exister sans sa table "parent"</p>
                            </div>
                            <div class="flex items-start space-x-2">
                                <span class="w-2 h-2 bg-orange-500 rounded-full mt-1.5"></span>
                                <p>Respecter l'ordre évite les erreurs de contraintes</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Additional Field Reference Table -->
                <div class="bg-gray-50 border border-gray-200 rounded-lg p-4 mt-6">
                    <h3 class="font-semibold text-gray-800 mb-3">📋 Référence des champs principaux</h3>
                    <div class="grid md:grid-cols-3 gap-4 text-xs">
                        <div>
                            <h4 class="font-semibold text-blue-700 mb-2">🗄️ Tables de base</h4>
                            <ul class="space-y-1 text-gray-600">
                                <li><strong>Department:</strong> name, order</li>
                                <li><strong>Function:</strong> designation, status</li>
                                <li><strong>Agent:</strong> first_name, last_name, matricule</li>
                                <li><strong>PublicHoliday:</strong> designation, date</li>
                                <li><strong>ScheduleType:</strong> designation, color</li>
                            </ul>
                        </div>
                        <div>
                            <h4 class="font-semibold text-green-700 mb-2">⏰ Rythmes et périodes</h4>
                            <ul class="space-y-1 text-gray-600">
                                <li><strong>DailyRotationPlan:</strong> id (PK), designation, schedule_type_id (FK)</li>
                                <li><strong>RotationPeriod:</strong> id (PK), daily_rotation_plan_id (FK), start_date, end_date, start_time, end_time</li>
                            </ul>
                        </div>
                        <div>
                            <h4 class="font-semibold text-purple-700 mb-2">📅 Roulements hebdomadaires</h4>
                            <ul class="space-y-1 text-gray-600">
                                <li><strong>ShiftSchedule:</strong> id (PK), name, type</li>
                                <li><strong>ShiftSchedulePeriod:</strong> id (PK), shift_schedule_id (FK), start_date, end_date</li>
                                <li><strong>ShiftScheduleWeek:</strong> id (PK), period_id (FK), week_number</li>
                                <li><strong>ShiftScheduleDailyPlan:</strong> id (PK), week_id (FK), daily_rotation_plan_id (FK), weekday</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>


            <!-- II.3) Système de permissions -->
            <section id="permissions-acces">
                <h3 class="text-lg font-semibold text-gray-700 border-b border-gray-200 pb-2 mb-4">
                    II.3) Système de permissions et accès
                </h3>
                
                <div class="space-y-4">
                    <!-- Niveaux de permissions -->
                    <div class="bg-gray-50 border border-gray-300 rounded-lg p-4">
                        <h4 class="font-semibold text-gray-800 mb-3">II.3.1) Niveaux de permissions</h4>
                        <div class="space-y-3 text-sm">
                            <div class="grid grid-cols-4 gap-3">
                                <div class="bg-white p-3 rounded border border-gray-300">
                                    <p class="font-bold text-gray-700">SA</p>
                                    <p class="text-xs text-gray-600">Super Administrateur</p>
                                    <p class="text-xs text-gray-600">Accès complet Django Admin + application + export/import</p>
                                </div>
                                <div class="bg-white p-3 rounded border border-gray-300">
                                    <p class="font-bold text-gray-700">A</p>
                                    <p class="text-xs text-gray-600">Administrateur</p>
                                    <p class="text-xs text-gray-600">Gestion agents/postes + modification permissions</p>
                                </div>
                                <div class="bg-white p-3 rounded border border-gray-300">
                                    <p class="font-bold text-gray-700">E</p>
                                    <p class="text-xs text-gray-600">Éditeur</p>
                                    <p class="text-xs text-gray-600">Édition du planning (à implémenter)</p>
                                </div>
                                <div class="bg-white p-3 rounded border border-gray-300">
                                    <p class="font-bold text-gray-700">R</p>
                                    <p class="text-xs text-gray-600">Lecteur</p>
                                    <p class="text-xs text-gray-600">Visualisation seulement</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Navigation adaptative -->
                    <div class="bg-gray-50 border border-gray-300 rounded-lg p-4">
                        <h4 class="font-semibold text-gray-800 mb-2">II.3.2) Navigation adaptative</h4>
                        <div class="text-gray-700 text-sm space-y-1">
                            <p>• Menu Administration adaptatif selon le niveau de permission utilisateur</p>
                            <p>• Accès superutilisateur via dropdown pour l'interface Django Admin</p>
                            <p>• Ordre des menus logique selon la séquence de création recommandée</p>
                        </div>
                    </div>

                    <!-- Sécurité -->
                    <div class="bg-gray-50 border border-gray-300 rounded-lg p-4">
                        <h4 class="font-semibold text-gray-800 mb-2">II.3.3) Sécurité</h4>
                        <div class="text-gray-700 text-sm space-y-1">
                            <p>• Création automatique de comptes Django pour chaque agent</p>
                            <p>• Changement de mot de passe obligatoire lors du premier login</p>
                            <p>• Validation des permissions côté serveur pour toutes les opérations</p>
                            <p>• Transactions atomiques pour les opérations critiques</p>
                        </div>
                    </div>
                </div>
            </section>
            </section>

            <!-- III) Guide d'utilisation -->
            <section id="guide-utilisation">
                <h2 class="text-xl font-semibold text-gray-800 border-b border-gray-200 pb-2 mb-4">
                    III) Guide d'utilisation
                </h2>

            <!-- III.1) Ordre recommandé de création -->
            <section id="ordre-creation">
                <h3 class="text-lg font-semibold text-gray-700 border-b border-gray-200 pb-2 mb-4">
                    III.1) Ordre de création des données
                </h3>
                <div class="bg-gray-100 border-l-4 border-gray-500 p-4 mb-6">
                    <p class="text-gray-800 font-medium">
                        IMPORTANT : L'ordre de création est fondamental pour garantir la cohérence des données et éviter les erreurs lors de la génération du planning.
                    </p>
                </div>

                <div class="space-y-4">
                    <!-- Étape 1 -->
                    <div class="bg-gray-50 border border-gray-300 rounded p-4">
                        <h4 class="font-semibold text-gray-800 mb-2">III.1.1) Départements</h4>
                        <p class="text-gray-700 mb-2">Les départements doivent être créés en premier, car une équipe doit obligatoirement être rattachée à un département.</p>
                        <div class="bg-white p-3 rounded border text-sm">
                            <strong>Navigation :</strong> Administration → Départements<br>
                            <strong>Priorité :</strong> Création obligatoire avant les équipes
                        </div>
                    </div>

                    <!-- Étape 2 -->
                    <div class="bg-gray-50 border border-gray-300 rounded p-4">
                        <h4 class="font-semibold text-gray-800 mb-2">III.1.2) Équipes</h4>
                        <p class="text-gray-700 mb-2">Une fois les départements créés, vous pouvez créer une ou plusieurs équipes, en les rattachant à un département existant.</p>
                        <div class="bg-white p-3 rounded border text-sm">
                            <strong>Dépendance :</strong> Nécessite les départements (étape 1)<br>
                            <strong>Principe :</strong> Chaque équipe doit être rattachée à un département
                        </div>
                    </div>

                    <!-- Étape 3 -->
                    <div class="bg-gray-50 border border-gray-300 rounded p-4">
                        <h4 class="font-semibold text-gray-800 mb-2">III.1.3) Postes</h4>
                        <p class="text-gray-700 mb-2">Chaque équipe peut comporter un ou plusieurs postes.</p>
                        <div class="bg-gray-100 p-3 rounded text-sm mb-3">
                            <strong>Important :</strong> Les postes sont créés dans un menu à part entière (Administration → Liste des Postes). C'est seulement au moment de la création de l'équipe qu'il est possible de leur affecter un agent, un plan de roulement et une règle de jour férié.
                        </div>
                        <p class="text-gray-700 mb-2 text-sm">Pour chaque poste d'une équipe, vous pouvez définir :</p>
                        <div class="bg-white p-3 rounded border text-sm space-y-2">
                            <p><strong>• Affectation d'un agent :</strong> Agent affecté sur une période précise</p>
                            <p><strong>• Plan de roulement :</strong> Planning automatique appliqué au poste</p>
                            <p><strong>• Règle jours fériés :</strong> Inclusion/exclusion des jours fériés</p>
                        </div>
                    </div>

                    <!-- Étape 4 -->
                    <div class="bg-gray-50 border border-gray-300 rounded p-4">
                        <h4 class="font-semibold text-gray-800 mb-2">III.1.4) Types d'horaires</h4>
                        <p class="text-gray-700 mb-2">Les types d'horaires sont des catégories de travail (ex : Jour travaillé, Congé payé, Astreinte sur site...).</p>
                        <div class="bg-white p-3 rounded border text-sm">
                            <strong>Navigation :</strong> Administration → Types d'horaires<br>
                            <strong>Priorité :</strong> Ils doivent être créés avant les rythmes quotidiens, car ces derniers en dépendent
                        </div>
                    </div>

                    <!-- Étape 5 -->
                    <div class="bg-gray-50 border border-gray-300 rounded p-4">
                        <h4 class="font-semibold text-gray-800 mb-2">III.1.5) Rythmes quotidiens</h4>
                        <p class="text-gray-700 mb-2">Les rythmes quotidiens représentent la composition d'une journée de travail (ex : 7h-19h) associé à un type d'horaire.</p>
                        <div class="bg-white p-3 rounded border text-sm">
                            <strong>Navigation :</strong> Administration → Rythmes Quotidien<br>
                            <strong>Dépendance :</strong> Nécessite les types d'horaire (étape 4)<br>
                            <strong>Usage :</strong> Ces rythmes sont les briques de base des plans de roulement
                        </div>
                    </div>

                    <!-- Étape 6 -->
                    <div class="bg-gray-50 border border-gray-300 rounded p-4">
                        <h4 class="font-semibold text-gray-800 mb-2">III.1.6) Plans de roulement</h4>
                        <p class="text-gray-700 mb-2">Un plan de roulement est une séquence hebdomadaire (ou multi-hebdomadaire) de rythmes quotidiens.</p>
                        <div class="bg-white p-3 rounded border text-sm">
                            <strong>Navigation :</strong> Administration → Roulements Hebdomadaires<br>
                            <strong>Dépendance :</strong> Nécessite les rythmes quotidiens (étape 5)<br>
                            <strong>Application :</strong> Il pourra ensuite être appliqué à un poste ou à une équipe
                        </div>
                    </div>
                </div>
            </section>

            <!-- III.2) Gestion des modules -->
            <section id="gestion-modules">
                <h3 class="text-lg font-semibold text-gray-700 border-b border-gray-200 pb-2 mb-4">
                    III.2) Gestion des modules d'administration
                </h3>

                <div class="space-y-6">
                    <!-- Modules de base -->
                    <div>
                        <h4 class="font-semibold text-gray-800 mb-3">III.2.1) Modules de données de base</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                <h5 class="font-semibold text-blue-800 mb-2">🗃️ Départements</h5>
                                <ul class="text-sm text-blue-700 space-y-1">
                                    <li>• Base hiérarchique obligatoire</li>
                                    <li>• Auto-incrémentation par 10 (10, 20, 30...)</li>
                                    <li>• Recherche en temps réel par nom</li>
                                    <li>• Ordre d'affichage intelligent</li>
                                </ul>
                            </div>
                            <div class="bg-purple-50 border border-purple-200 rounded-lg p-4">
                                <h5 class="font-semibold text-purple-800 mb-2">🗃️ Liste des Postes</h5>
                                <ul class="text-sm text-purple-700 space-y-1">
                                    <li>• Fonctions de l'organisation</li>
                                    <li>• Statuts actif/inactif avec badges</li>
                                    <li>• Descriptions complètes sans troncature</li>
                                    <li>• Filtrage avancé par statut</li>
                                </ul>
                            </div>
                            <div class="bg-pink-50 border border-pink-200 rounded-lg p-4">
                                <h5 class="font-semibold text-pink-800 mb-2">🗃️ Liste des Agents</h5>
                                <ul class="text-sm text-pink-700 space-y-1">
                                    <li>• Personnel avec permissions</li>
                                    <li>• Recherche par matricule, nom, prénom</li>
                                    <li>• Gestion des permissions intégrée</li>
                                    <li>• Tri multi-colonnes avec conservation filtres</li>
                                </ul>
                            </div>
                            <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                                <h5 class="font-semibold text-yellow-800 mb-2">🗃️ Jours Fériés</h5>
                                <ul class="text-sm text-yellow-700 space-y-1">
                                    <li>• Dates exceptionnelles</li>
                                    <li>• Compteurs par année</li>
                                    <li>• Fonction de duplication</li>
                                    <li>• Validation anti-doublons</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Modules de planification -->
                    <div>
                        <h4 class="font-semibold text-gray-800 mb-3">III.2.2) Modules de planification</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                                <h5 class="font-semibold text-green-800 mb-2">🗃️ Types d'Horaires</h5>
                                <ul class="text-sm text-green-700 space-y-1">
                                    <li>• Catégories de travail avec couleurs</li>
                                    <li>• Abréviations optionnelles (MAT, APM, NUIT)</li>
                                    <li>• Validation automatique des formats</li>
                                    <li>• Protection contre suppression si liés</li>
                                </ul>
                            </div>
                            <div class="bg-teal-50 border border-teal-200 rounded-lg p-4">
                                <h5 class="font-semibold text-teal-800 mb-2">🗃️ Rythmes Quotidiens</h5>
                                <ul class="text-sm text-teal-700 space-y-1">
                                    <li>• Modèles d'horaires quotidiens</li>
                                    <li>• Interface accordion avec expansion</li>
                                    <li>• Gestion des périodes intégrée</li>
                                    <li>• Validation des équipes de nuit</li>
                                </ul>
                            </div>
                            <div class="bg-indigo-50 border border-indigo-200 rounded-lg p-4">
                                <h5 class="font-semibold text-indigo-800 mb-2">🗃️ Roulements Hebdomadaires</h5>
                                <ul class="text-sm text-indigo-700 space-y-1">
                                    <li>• Plannings récurrents multi-semaines</li>
                                    <li>• Tableau hebdomadaire interactif</li>
                                    <li>• Assignation multiple de rythmes par jour</li>
                                    <li>• Duplication instantanée de semaines</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Fonctionnalités communes -->
                    <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                        <h4 class="font-semibold text-gray-800 mb-3">III.2.3) Fonctionnalités communes à tous les modules</h4>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm">
                            <div>
                                <h5 class="font-semibold text-gray-700 mb-2">🔍 Recherche et filtrage</h5>
                                <ul class="text-gray-600 space-y-1">
                                    <li>• Recherche en temps réel (délai 300ms)</li>
                                    <li>• Tri multi-colonnes (ASC/DESC)</li>
                                    <li>• Conservation des filtres lors navigation</li>
                                    <li>• Filtres avancés par statut</li>
                                </ul>
                            </div>
                            <div>
                                <h5 class="font-semibold text-gray-700 mb-2">🎨 Interface utilisateur</h5>
                                <ul class="text-gray-600 space-y-1">
                                    <li>• Modales HTMX sans rechargement</li>
                                    <li>• Split buttons pour actions rapides</li>
                                    <li>• Badges colorés pour statuts visuels</li>
                                    <li>• Design harmonisé avec Tailwind CSS</li>
                                </ul>
                            </div>
                            <div>
                                <h5 class="font-semibold text-gray-700 mb-2">⚡ Performance</h5>
                                <ul class="text-gray-600 space-y-1">
                                    <li>• Chargement à la demande</li>
                                    <li>• Mise à jour temps réel</li>
                                    <li>• Suppression de la pagination</li>
                                    <li>• API REST dédiée</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- III.3) Cas particuliers -->
            <section id="cas-particuliers">
                <h3 class="text-lg font-semibold text-gray-700 border-b border-gray-200 pb-2 mb-4">
                    III.3) Comportements automatiques du système
                </h3>
                
                <div class="bg-indigo-50 border-l-4 border-indigo-400 p-4 mb-6">
                    <h3 class="font-semibold text-indigo-800 mb-2">Comportement du système</h3>
                    <p class="text-indigo-700 text-sm">
                        Le système adopte des comportements automatiques selon la configuration des postes. 
                        Voici les différents scenarios possibles :
                    </p>
                </div>

                <div class="space-y-4">
                    <!-- Scenario 1 -->
                    <div class="bg-white border border-gray-200 rounded-lg p-4">
                        <div class="flex items-start">
                            <span class="bg-orange-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold mr-3 mt-1">1</span>
                            <div class="flex-1">
                                <h4 class="font-semibold text-gray-800 mb-2">Poste avec plan de roulement mais sans agent</h4>
                                <p class="text-sm text-gray-600">
                                    → <strong>Génération automatique</strong> de planning avec "Poste Vacant" (PV) comme type d'horaire 
                                    en lieu et place du type d'horaire préexistant.
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Scenario 2 -->
                    <div class="bg-white border border-gray-200 rounded-lg p-4">
                        <div class="flex items-start">
                            <span class="bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold mr-3 mt-1">2</span>
                            <div class="flex-1">
                                <h4 class="font-semibold text-gray-800 mb-2">Poste avec agent mais sans plan de roulement</h4>
                                <p class="text-sm text-gray-600">
                                    → <strong>La ligne de planning de l'agent reste vide</strong>
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Scenario 3 -->
                    <div class="bg-white border border-gray-200 rounded-lg p-4">
                        <div class="flex items-start">
                            <span class="bg-green-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold mr-3 mt-1">3</span>
                            <div class="flex-1">
                                <h4 class="font-semibold text-gray-800 mb-2">Poste avec agent et plan de roulement</h4>
                                <p class="text-sm text-gray-600">
                                    → <strong>Planning généré automatiquement</strong> avec les rythmes définis
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Scenario 4 -->
                    <div class="bg-white border border-gray-200 rounded-lg p-4">
                        <div class="flex items-start">
                            <span class="bg-blue-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold mr-3 mt-1">4</span>
                            <div class="flex-1">
                                <h4 class="font-semibold text-gray-800 mb-2">Poste exclu des jours fériés</h4>
                                <p class="text-sm text-gray-600">
                                    → <strong>Le roulement s'applique sans tenir compte des jours fériés</strong>
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Scenario 5 -->
                    <div class="bg-white border border-gray-200 rounded-lg p-4">
                        <div class="flex items-start">
                            <span class="bg-purple-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold mr-3 mt-1">5</span>
                            <div class="flex-1">
                                <h4 class="font-semibold text-gray-800 mb-2">Poste inclus dans les jours fériés</h4>
                                <p class="text-sm text-gray-600 mb-2">
                                    → <strong>Le planning est modifié ou annulé selon les jours fériés</strong>
                                </p>
                                <div class="bg-purple-50 p-2 rounded text-xs text-purple-700">
                                    <strong>Exemple :</strong> Si le lundi est férié mais initialement associé à un rythme quotidien 
                                    dans le plan de roulement, alors le rythme de ce jour est supprimé.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Note importante -->
                <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mt-6">
                    <h4 class="font-semibold text-yellow-800 mb-2">💡 Principe important de préservation des données</h4>
                    <p class="text-sm text-yellow-700 mb-2">
                        Il faut bien comprendre que ce qui est généré remplit automatiquement le planning mais reste "en dessous" 
                        de ce que les utilisateurs imputent au planning manuellement.
                    </p>
                    <div class="bg-yellow-100 p-3 rounded text-xs text-yellow-800">
                        <strong>Exemple concret :</strong> Si dans une équipe j'associe un poste et un agent mais sans plan de roulement, 
                        je peux alors imputer un rythme quotidien associé à un type d'horaire sur un jour particulier à un agent. 
                        Mais si j'associe dans un second temps à ce poste un roulement, le roulement se génère sur le planning 
                        mais <strong>sans écraser les jours déjà définis en amont</strong>. Ceci pour ne pas perdre de données.
                    </div>
                </div>
            </section>
            </section>

            <!-- IV) Administration avancée -->
            <section id="administration-avancee">
                <h2 class="text-xl font-semibold text-gray-800 border-b border-gray-200 pb-2 mb-4">
                    IV) Administration avancée
                </h2>

            <!-- IV.1) Import/Export des données -->
            <section id="import-export">
                <h3 class="text-lg font-semibold text-gray-700 border-b border-gray-200 pb-2 mb-4">
                    IV.1) Import/Export des données
                </h3>
                
                <div class="bg-gray-100 border-l-4 border-gray-500 p-4 mb-6">
                    <h4 class="font-semibold text-gray-800 mb-2">Accès restreint - Superutilisateur uniquement</h4>
                    <p class="text-gray-700 text-sm">
                        Les fonctionnalités d'import/export sont <strong>exclusivement réservées aux superutilisateurs</strong>. 
                        Elles permettent de sauvegarder et restaurer l'intégralité des données de l'application via l'interface Django Admin.
                    </p>
                </div>

                <!-- Export des données -->
                <div class="mb-8">
                    <h4 class="font-semibold text-gray-800 mb-4">IV.1.1) Export des données</h4>
                    
                    <div class="space-y-4">
                        <!-- Export global -->
                        <div class="bg-gray-50 border border-gray-300 rounded p-4">
                            <h5 class="font-semibold text-gray-800 mb-2">Export global (recommandé)</h5>
                            <p class="text-sm text-gray-700 mb-3">
                                Exporte <strong>toutes les données</strong> de l'application en un seul fichier ZIP.
                            </p>
                            <div class="bg-white p-3 rounded border text-sm text-gray-700">
                                <p><strong>Accès :</strong> Django Admin → Core → Bouton "Exporter Toutes les Données"</p>
                                <p><strong>Fichier généré :</strong> <code>YYYY-MM-DD_HHMMSS_export_global_planning.zip</code></p>
                                <p><strong>Contenu :</strong> 10 fichiers JSON avec tous les modèles de l'application</p>
                            </div>
                        </div>

                        <!-- Export individuel -->
                        <div class="bg-gray-50 border border-gray-300 rounded p-4">
                            <h5 class="font-semibold text-gray-800 mb-2">Export individuel par modèle</h5>
                            <p class="text-sm text-gray-700 mb-3">
                                Exporte un seul type de données à la fois. Utile pour des sauvegardes partielles ou des transferts sélectifs.
                            </p>
                            <div class="bg-white p-3 rounded border text-sm text-gray-700">
                                <p><strong>Accès :</strong> Django Admin → Core → [Modèle] → Bouton "Exporter JSON"</p>
                                <p><strong>Fichier généré :</strong> <code>YYYY-MM-DD_[modele].json</code></p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Import des données -->
                <div class="mb-8">
                    <h4 class="font-semibold text-gray-800 mb-4">IV.1.2) Import des données</h4>
                    
                    <div class="bg-gray-100 border border-gray-400 rounded p-4 mb-6">
                        <h5 class="font-semibold text-gray-800 mb-2">ATTENTION - Remplacement complet</h5>
                        <p class="text-sm text-gray-700">
                            L'import <strong>supprime définitivement</strong> toutes les données existantes du modèle et les remplace 
                            par le contenu du fichier JSON. Cette action est <strong>irréversible</strong>.
                        </p>
                    </div>

                    <!-- Ordre d'importation obligatoire -->
                    <div class="bg-gray-50 border border-gray-300 rounded p-4 mb-6">
                        <h5 class="font-semibold text-gray-800 mb-3">Ordre d'importation OBLIGATOIRE</h5>
                        <p class="text-sm text-gray-700 mb-4">
                            Les modèles ont des <strong>dépendances hiérarchiques</strong>. Il est impératif de respecter cet ordre 
                            pour éviter les erreurs de clés étrangères :
                        </p>
                        
                        <div class="bg-white border border-gray-300 rounded p-3">
                            <ol class="list-decimal list-inside space-y-1 text-sm text-gray-800">
                                <li><strong>Départements</strong> → <code>YYYY-MM-DD_departments.json</code></li>
                                <li><strong>Agents</strong> → <code>YYYY-MM-DD_agents.json</code></li>
                                <li><strong>Fonctions (Postes)</strong> → <code>YYYY-MM-DD_functions.json</code></li>
                                <li><strong>Types d'horaire</strong> → <code>YYYY-MM-DD_schedule_types.json</code></li>
                                <li><strong>Rythmes quotidiens</strong> → <code>YYYY-MM-DD_daily_rotation_plans.json</code></li>
                                <li><strong>Périodes de rotation</strong> → <code>YYYY-MM-DD_rotation_periods.json</code></li>
                                <li><strong>Plannings de poste</strong> → <code>YYYY-MM-DD_shift_schedules.json</code></li>
                                <li><strong>Périodes de planning de poste</strong> → <code>YYYY-MM-DD_shift_schedule_periods.json</code></li>
                                <li><strong>Semaines de planning</strong> → <code>YYYY-MM-DD_shift_schedule_weeks.json</code></li>
                                <li><strong>Plans quotidiens de planning</strong> → <code>YYYY-MM-DD_shift_schedule_daily_plans.json</code></li>
                            </ol>
                        </div>
                        
                        <div class="mt-3 p-2 bg-gray-100 rounded text-xs text-gray-700">
                            <strong>Note :</strong> Si vous utilisez l'export global, tous les fichiers JSON sont déjà nommés 
                            avec le bon préfixe de date et prêts à être importés dans l'ordre indiqué.
                        </div>
                    </div>

                    <!-- Procédure d'import -->
                    <div class="bg-gray-50 border border-gray-300 rounded p-4">
                        <h5 class="font-semibold text-gray-800 mb-3">Procédure d'import</h5>
                        <div class="space-y-2 text-sm text-gray-700">
                            <p><strong>1.</strong> Accès : Django Admin → Core → [Modèle] → Bouton "Importer JSON"</p>
                            <p><strong>2.</strong> Sélection : Choisir le fichier JSON correspondant au modèle</p>
                            <p><strong>3.</strong> Confirmation : Cocher la case de confirmation obligatoire</p>
                            <p><strong>4.</strong> Validation : Le système vérifie automatiquement la structure et les dépendances</p>
                            <p><strong>5.</strong> Import : Remplacement complet des données si validation réussie</p>
                        </div>
                    </div>
                </div>

                <!-- Modèles supportés -->
                <div class="mb-8">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">🗃️ Modèles supportés</h3>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <!-- Modèles de base -->
                        <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                            <h4 class="font-semibold text-gray-800 mb-3">📊 Données de base</h4>
                            <ul class="space-y-1 text-sm text-gray-600">
                                <li>• Départements</li>
                                <li>• Agents</li>
                                <li>• Fonctions (Postes)</li>
                                <li>• Types d'horaire</li>
                            </ul>
                        </div>

                        <!-- Modèles de planification -->
                        <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                            <h4 class="font-semibold text-gray-800 mb-3">📅 Données de planification</h4>
                            <ul class="space-y-1 text-sm text-gray-600">
                                <li>• Rythmes quotidiens</li>
                                <li>• Périodes de rotation</li>
                                <li>• Plannings de poste</li>
                                <li>• Périodes de planning</li>
                                <li>• Semaines de planning</li>
                                <li>• Plans quotidiens</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Bonnes pratiques -->
                <div class="bg-gray-50 border border-gray-300 rounded p-4">
                    <h5 class="font-semibold text-gray-800 mb-3">Bonnes pratiques</h5>
                    <ul class="space-y-1 text-sm text-gray-700">
                        <li>• <strong>Sauvegarde préventive :</strong> Toujours exporter avant d'importer</li>
                        <li>• <strong>Environnement de test :</strong> Tester d'abord sur une copie de la base</li>
                        <li>• <strong>Vérification :</strong> Contrôler les données après import</li>
                        <li>• <strong>Documentation :</strong> Noter la date et la raison de chaque import/export</li>
                        <li>• <strong>Accès restreint :</strong> Seuls les superutilisateurs peuvent utiliser ces fonctions</li>
                    </ul>
                </div>
            </section>

            <!-- IV.2) Interface Django Admin -->
            <section id="interface-django">
                <h3 class="text-lg font-semibold text-gray-700 border-b border-gray-200 pb-2 mb-4">
                    IV.2) Interface Django Admin
                </h3>
                
                <div class="space-y-4">
                    <!-- Accès -->
                    <div class="bg-gray-50 border border-gray-300 rounded p-4">
                        <h4 class="font-semibold text-gray-800 mb-2">IV.2.1) Accès à l'interface</h4>
                        <div class="text-gray-700 text-sm space-y-1">
                            <p><strong>URL :</strong> http://127.0.0.1:8000/admin/</p>
                            <p><strong>Accès :</strong> Menu Administration → Interface d'Administration Django (superutilisateurs uniquement)</p>
                            <p><strong>Identifiants par défaut :</strong></p>
                            <ul class="ml-4 space-y-1">
                                <li>• Utilisateur : azerty</li>
                                <li>• Email : azerty@azerty.com</li>
                                <li>• Mot de passe : azerty</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Fonctionnalités -->
                    <div class="bg-gray-50 border border-gray-300 rounded p-4">
                        <h4 class="font-semibold text-gray-800 mb-2">IV.2.2) Fonctionnalités spécifiques</h4>
                        <div class="text-gray-700 text-sm space-y-1">
                            <p><strong>Export global :</strong> Bouton "Exporter Toutes les Données" sur la page Core</p>
                            <p><strong>Export individuel :</strong> Boutons "Exporter JSON" sur chaque modèle</p>
                            <p><strong>Import sécurisé :</strong> Boutons "Importer JSON" avec confirmations multiples</p>
                            <p><strong>Gestion avancée :</strong> Configuration système et maintenance technique</p>
                        </div>
                    </div>

                    <!-- Navigation -->
                    <div class="bg-gray-50 border border-gray-300 rounded p-4">
                        <h4 class="font-semibold text-gray-800 mb-2">IV.2.3) Navigation dans Django Admin</h4>
                        <div class="text-gray-700 text-sm space-y-1">
                            <p><strong>Page Core :</strong> Point d'entrée principal avec export global</p>
                            <p><strong>Modèles supportés :</strong> 10 modèles avec fonctions import/export individuelles</p>
                            <p><strong>Sécurité :</strong> Préservation automatique des comptes superutilisateurs lors des imports</p>
                            <p><strong>Interface moderne :</strong> Templates personnalisés avec boutons d'action intégrés</p>
                        </div>
                    </div>
                </div>
            </section>
            </section>
        </div>
    </div>
</div>
{% endblock %}